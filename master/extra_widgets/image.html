<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.5" />
<title>concur.extra_widgets.image API documentation</title>
<meta name="description" content="Scrollable, zoomable image widget with overlay support." />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>concur.extra_widgets.image</code></h1>
</header>
<section id="section-intro">
<p>Scrollable, zoomable image widget with overlay support.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34; Scrollable, zoomable image widget with overlay support. &#34;&#34;&#34;


import copy

import numpy as np
import imgui
from concur.widgets import child
from concur.draw import image as raw_image
from concur.extra_widgets.pan_zoom import PanZoom, pan_zoom
from concur.core import orr, optional


def image(name, state, width=None, height=None, content_gen=None):
    &#34;&#34;&#34; The image widget.

    `state` is an instance of `concur.extra_widgets.image.Image`. Width and
    height are optional; if not specified, the widget stretches to fill
    the parent element. Returns a modified `Image` object tagged with `name` on user interaction.

    `content_gen` is a function that takes as an argument a transformation
    object `concur.extra_widgets.pan_zoom.TF`, and returns a widget that will be displayed as image
    overlay. Any events fired by the overlay widget are passed through unchanged.

    The transformation object can be used to position and scale the overlay widget appropriately.
    It can be used explicitly, or passed as the `tf` argument to any geometrical objects
    in `concur.draw`. Widgets which don&#39;t accept the `tf` arguments, such as buttons, can be
    wrapped inside the `concur.widgets.transform` widget.
    See the [image example](https://github.com/potocpav/python-concur/blob/master/examples/image.py) for example usage.

    It is very common to use `concur.partial` to pass additional arguments to the `content_gen` function:

    ```python
    def overlay(pos, tf):
        return c.draw.circle(*pos, 10, (0,0,0,1), tf=tf)

    _, im = yield from c.image(&#34;Image&#34;, im, content_gen=c.partial(overlay, pos))
    ```
    &#34;&#34;&#34;
    while True:
        _, (st, child_event) = yield from pan_zoom(name, state.pan_zoom, width, height, content_gen=lambda tf: orr([
            raw_image(state.tex_id, state.tex_w, state.tex_h, tf),
            optional(content_gen is not None, content_gen, tf),
        ]))
        if st is not None:
            new_state = copy.deepcopy(state)
            new_state.pan_zoom = st
            return name, new_state
        else:
            return child_event
        yield


class Image(object):
    &#34;&#34;&#34; Image state containing pan and zoom information, and texture data. &#34;&#34;&#34;
    def __init__(self, image=None):
        &#34;&#34;&#34; `image ` must be something convertible to `numpy.array`: greyscale, RGB, or RGBA.
        Channel is in the last dimension.
        &#34;&#34;&#34;
        # TODO: remove this hack with last_{w,h}; create a more principled way of changing content size
        self.last_w, self.last_h = None, None
        self.tex_id = None
        self.garbage_tex_id = None
        self.pan_zoom = PanZoom((0, 0), (1, 1))
        self.change_image(image)

    def change_image(self, image):
        &#34;&#34;&#34; Change the image for a different one. `image ` must be None, or something convertible to
        `numpy.array` in greyscale, RGB, or RGBA format. Channel is in the last dimension.
        If None, a black placeholder image is displayed.

        `change_image` must be called at most once per each frame for one Image.
        &#34;&#34;&#34;
        from concur.integrations.opengl import texture, rm_texture
        if self.garbage_tex_id is not None:
            rm_texture(self.garbage_tex_id)
            self.garbage_tex_id = None
        self.garbage_tex_id = self.tex_id # Hold onto the old texture ID for (at least) one frame
        if image is None:
            self.tex_id = texture(np.zeros((1,1,3)))
            self.tex_w, self.tex_h = 1, 1
        else:
            if not isinstance(image, np.ndarray):
                image = np.array(image) # support PyTorch tensors and PIL images
            self.tex_id = texture(image)
            self.tex_w, self.tex_h = image.shape[1], image.shape[0]

            if self.last_w != self.tex_w or self.last_h != self.tex_h:
                self.last_w, self.last_h = self.tex_w, self.tex_h
                self.pan_zoom.reset_view((0,0), (self.tex_w, self.tex_h))

    def reset_view(self):
        &#34;&#34;&#34; Reset view so that the whole image fits into the widget. &#34;&#34;&#34;
        return self.pan_zoom.reset_view()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="concur.extra_widgets.image.image"><code class="name flex">
<span>def <span class="ident">image</span></span>(<span>name, state, width=None, height=None, content_gen=None)</span>
</code></dt>
<dd>
<section class="desc"><p>The image widget.</p>
<p><code>state</code> is an instance of <a title="concur.extra_widgets.image.Image" href="#concur.extra_widgets.image.Image"><code>Image</code></a>. Width and
height are optional; if not specified, the widget stretches to fill
the parent element. Returns a modified <a title="concur.extra_widgets.image.Image" href="#concur.extra_widgets.image.Image"><code>Image</code></a> object tagged with <code>name</code> on user interaction.</p>
<p><code>content_gen</code> is a function that takes as an argument a transformation
object <a title="concur.extra_widgets.pan_zoom.TF" href="pan_zoom.html#concur.extra_widgets.pan_zoom.TF"><code>TF</code></a>, and returns a widget that will be displayed as image
overlay. Any events fired by the overlay widget are passed through unchanged.</p>
<p>The transformation object can be used to position and scale the overlay widget appropriately.
It can be used explicitly, or passed as the <code>tf</code> argument to any geometrical objects
in <a title="concur.draw" href="../draw.html"><code>concur.draw</code></a>. Widgets which don't accept the <code>tf</code> arguments, such as buttons, can be
wrapped inside the <a title="concur.widgets.transform" href="../widgets.html#concur.widgets.transform"><code>transform()</code></a> widget.
See the <a href="https://github.com/potocpav/python-concur/blob/master/examples/image.py">image example</a> for example usage.</p>
<p>It is very common to use <a title="concur.partial" href="../index.html#concur.partial"><code>partial()</code></a> to pass additional arguments to the <code>content_gen</code> function:</p>
<pre><code class="python">def overlay(pos, tf):
    return c.draw.circle(*pos, 10, (0,0,0,1), tf=tf)

_, im = yield from c.image(&quot;Image&quot;, im, content_gen=c.partial(overlay, pos))
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def image(name, state, width=None, height=None, content_gen=None):
    &#34;&#34;&#34; The image widget.

    `state` is an instance of `concur.extra_widgets.image.Image`. Width and
    height are optional; if not specified, the widget stretches to fill
    the parent element. Returns a modified `Image` object tagged with `name` on user interaction.

    `content_gen` is a function that takes as an argument a transformation
    object `concur.extra_widgets.pan_zoom.TF`, and returns a widget that will be displayed as image
    overlay. Any events fired by the overlay widget are passed through unchanged.

    The transformation object can be used to position and scale the overlay widget appropriately.
    It can be used explicitly, or passed as the `tf` argument to any geometrical objects
    in `concur.draw`. Widgets which don&#39;t accept the `tf` arguments, such as buttons, can be
    wrapped inside the `concur.widgets.transform` widget.
    See the [image example](https://github.com/potocpav/python-concur/blob/master/examples/image.py) for example usage.

    It is very common to use `concur.partial` to pass additional arguments to the `content_gen` function:

    ```python
    def overlay(pos, tf):
        return c.draw.circle(*pos, 10, (0,0,0,1), tf=tf)

    _, im = yield from c.image(&#34;Image&#34;, im, content_gen=c.partial(overlay, pos))
    ```
    &#34;&#34;&#34;
    while True:
        _, (st, child_event) = yield from pan_zoom(name, state.pan_zoom, width, height, content_gen=lambda tf: orr([
            raw_image(state.tex_id, state.tex_w, state.tex_h, tf),
            optional(content_gen is not None, content_gen, tf),
        ]))
        if st is not None:
            new_state = copy.deepcopy(state)
            new_state.pan_zoom = st
            return name, new_state
        else:
            return child_event
        yield</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="concur.extra_widgets.image.Image"><code class="flex name class">
<span>class <span class="ident">Image</span></span>
<span>(</span><span>image=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Image state containing pan and zoom information, and texture data. </p>
<p><code>image</code> must be something convertible to <code>numpy.array</code>: greyscale, RGB, or RGBA.
Channel is in the last dimension.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Image(object):
    &#34;&#34;&#34; Image state containing pan and zoom information, and texture data. &#34;&#34;&#34;
    def __init__(self, image=None):
        &#34;&#34;&#34; `image ` must be something convertible to `numpy.array`: greyscale, RGB, or RGBA.
        Channel is in the last dimension.
        &#34;&#34;&#34;
        # TODO: remove this hack with last_{w,h}; create a more principled way of changing content size
        self.last_w, self.last_h = None, None
        self.tex_id = None
        self.garbage_tex_id = None
        self.pan_zoom = PanZoom((0, 0), (1, 1))
        self.change_image(image)

    def change_image(self, image):
        &#34;&#34;&#34; Change the image for a different one. `image ` must be None, or something convertible to
        `numpy.array` in greyscale, RGB, or RGBA format. Channel is in the last dimension.
        If None, a black placeholder image is displayed.

        `change_image` must be called at most once per each frame for one Image.
        &#34;&#34;&#34;
        from concur.integrations.opengl import texture, rm_texture
        if self.garbage_tex_id is not None:
            rm_texture(self.garbage_tex_id)
            self.garbage_tex_id = None
        self.garbage_tex_id = self.tex_id # Hold onto the old texture ID for (at least) one frame
        if image is None:
            self.tex_id = texture(np.zeros((1,1,3)))
            self.tex_w, self.tex_h = 1, 1
        else:
            if not isinstance(image, np.ndarray):
                image = np.array(image) # support PyTorch tensors and PIL images
            self.tex_id = texture(image)
            self.tex_w, self.tex_h = image.shape[1], image.shape[0]

            if self.last_w != self.tex_w or self.last_h != self.tex_h:
                self.last_w, self.last_h = self.tex_w, self.tex_h
                self.pan_zoom.reset_view((0,0), (self.tex_w, self.tex_h))

    def reset_view(self):
        &#34;&#34;&#34; Reset view so that the whole image fits into the widget. &#34;&#34;&#34;
        return self.pan_zoom.reset_view()</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="concur.extra_widgets.image.Image.change_image"><code class="name flex">
<span>def <span class="ident">change_image</span></span>(<span>self, image)</span>
</code></dt>
<dd>
<section class="desc"><p>Change the image for a different one. <code>image</code> must be None, or something convertible to
<code>numpy.array</code> in greyscale, RGB, or RGBA format. Channel is in the last dimension.
If None, a black placeholder image is displayed.</p>
<p><code>change_image</code> must be called at most once per each frame for one Image.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def change_image(self, image):
    &#34;&#34;&#34; Change the image for a different one. `image ` must be None, or something convertible to
    `numpy.array` in greyscale, RGB, or RGBA format. Channel is in the last dimension.
    If None, a black placeholder image is displayed.

    `change_image` must be called at most once per each frame for one Image.
    &#34;&#34;&#34;
    from concur.integrations.opengl import texture, rm_texture
    if self.garbage_tex_id is not None:
        rm_texture(self.garbage_tex_id)
        self.garbage_tex_id = None
    self.garbage_tex_id = self.tex_id # Hold onto the old texture ID for (at least) one frame
    if image is None:
        self.tex_id = texture(np.zeros((1,1,3)))
        self.tex_w, self.tex_h = 1, 1
    else:
        if not isinstance(image, np.ndarray):
            image = np.array(image) # support PyTorch tensors and PIL images
        self.tex_id = texture(image)
        self.tex_w, self.tex_h = image.shape[1], image.shape[0]

        if self.last_w != self.tex_w or self.last_h != self.tex_h:
            self.last_w, self.last_h = self.tex_w, self.tex_h
            self.pan_zoom.reset_view((0,0), (self.tex_w, self.tex_h))</code></pre>
</details>
</dd>
<dt id="concur.extra_widgets.image.Image.reset_view"><code class="name flex">
<span>def <span class="ident">reset_view</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Reset view so that the whole image fits into the widget.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def reset_view(self):
    &#34;&#34;&#34; Reset view so that the whole image fits into the widget. &#34;&#34;&#34;
    return self.pan_zoom.reset_view()</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="concur.extra_widgets" href="index.html">concur.extra_widgets</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="concur.extra_widgets.image.image" href="#concur.extra_widgets.image.image">image</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="concur.extra_widgets.image.Image" href="#concur.extra_widgets.image.Image">Image</a></code></h4>
<ul class="">
<li><code><a title="concur.extra_widgets.image.Image.change_image" href="#concur.extra_widgets.image.Image.change_image">change_image</a></code></li>
<li><code><a title="concur.extra_widgets.image.Image.reset_view" href="#concur.extra_widgets.image.Image.reset_view">reset_view</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.5</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>